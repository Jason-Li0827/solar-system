<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body {
            /*centers the whole script code into the middle of window*/
            margin: 10;
            display: flex;
            justify-content: center;
            background-color: darkblue;
        }
        
        .one {
            /*This class includes the switch*/
            /*This makes centers it*/
            margin-top: 700px;
            display: flex;
            justify-content: center;
        }
        
        .two {
            /*This class includes the text for dalay*/
            /*This makes the text centered*/
            margin: auto;
            display: flex;
            justify-content: center;
        }
        
        .three {
            /*This class includes the delay input box and the submit button*/
            /*This makes the text centered*/
            margin: auto;
            display: flex;
            justify-content: center;
        }
    </style>
</head>

<body onload="setUp()">
    <!--Html elements-->
    <canvas id=myCanvas width=1500 height=1500></canvas>

    <div>
        <!--This div includes the switch-->
        <div class="one">
            <button onclick="start()" id="switch" style="height:100px;width:100px">start</button>
        </div>

        <!--This div includes the text for dalay-->
        <div class="two">
            <p>Change the delay!</p>
        </div>

        <!--This div includes the delay input box and the submit button-->
        <div class="three">
            <!--Here you can change the default value of delay-->
            <input type="text" id="delay" value=10>
            <button onclick="submit()">Enter</button>
        </div>
    </div>

    <script>
        //center of solor system
        var midX = 750;
        var midY = 750;
        //get canvas
        var ctx = myCanvas.getContext("2d");

        //get images
        var sun = new Image();
        sun.src = "sun.png";

        var mercury = new Image();
        mercury.src = "mercury.png";

        var venus = new Image();
        venus.src = "venus.png";

        var earth = new Image();
        earth.src = "earth.png";

        var mars = new Image();
        mars.src = "mars.png";

        var jupiter = new Image();
        jupiter.src = "jupiter.png";

        var saturn = new Image();
        saturn.src = "saturn.png";

        var uranus = new Image();
        uranus.src = "uranus.png";

        var neptune = new Image();
        neptune.src = "neptune.png";
        //This is the background image
        var background = new Image();
        background.src = "sky.png";
        //Downloads the images and wait until it's done
        gaidaAtteluIeladi(done, sun, mercury, venus, earth, mars, jupiter, saturn, uranus, neptune, background);

        //setting variables
        var mercuryLoc = venusLoc = earthLoc = marsLoc = jupiterLoc = saturnLoc = uranusLoc = neptuneLoc = 0; //radians of angles
        //size of planets
        var planetR = {
            "sun": 80,
            "mercury": 36,
            "venus": 36,
            "earth": 48,
            "mars": 48,
            "jupiter": 96,
            "saturn": 96,
            "uranus": 72,
            "neptune": 72
        };
        //the distance between planet and the sun
        var planetD = {
            "mercury": 70,
            "venus": 120,
            "earth": 215,
            "mars": 300,
            "jupiter": 400,
            "saturn": 500,
            "uranus": 600,
            "neptune": 700
        };
        //the speed of each planet
        var planetS = {
            "mercury": 1,
            "venus": 1 / 2.5,
            "earth": 1 / 4.1,
            "mars": 1 / 7.8,
            "jupiter": 1 / 49,
            "saturn": 1 / 119,
            "uranus": 1 / 347,
            "neptune": 1 / 679.55
        };

        //basically does nothing
        //but gives a console log when all images all loaded
        function done() {
            console.log("Images loaded!")
        }

        //runs the main function once so that it draws the background image and the planets
        //then use the pause function to stop it
        function setUp() {
            start();
            pause();
        }

        //submits the input delay value to main
        function submit() {
            delay = document.getElementById("delay").value;
        }

        //starts the programme
        function start() {
            //gets the latest delay value to main
            delay = document.getElementById("delay").value;
            solarSystem();
            //This is needed so that there is only one button not two(start and pause)
            document.getElementById("switch").onclick = pause;
            document.getElementById("switch").innerHTML = "pause";
        }

        //pauses the programme
        function pause() {
            clearTimeout(running);
            //This is needed so that there is only one button not two(start and pause)
            document.getElementById("switch").onclick = start;
            document.getElementById("switch").innerHTML = "start";
        }

        //calculate the middle of planet
        function getMid(imgName, x, y) {
            var width = planetR[imgName];
            var midP = {
                "x": x - 1 / 2 * width,
                "y": y - 1 / 2 * width
            };
            return midP;
        }

        //draws the sun
        function drawSun() {
            var middle = getMid("sun", midX, midY);
            ctx.drawImage(sun, middle["x"], middle["y"]);
        }

        //draws the planets
        function planets(planetImg, planetName, i) {
            //get the distance between planet and sun(midpoint)
            var r = planetD[planetName];
            //get the speed of revolutionary period
            var s = planetS[planetName];
            //The planet's orbit
            //Calculates the x and y coordinates as if the center is (0;0)
            //Then add the real midpoint's x and y value(x;y) to the result
            pointAngleInRadians = i;
            var x = Math.cos(pointAngleInRadians) * r + midX;
            var y = Math.sin(pointAngleInRadians) * r + midY;
            //get the midponi coordinate andn draw the planet
            var middle = getMid(planetName, x, y);
            //Draws the planet
            ctx.drawImage(planetImg, middle["x"], middle["y"]);
            //Add 1/8 radians to the planet's angle
            i += s * 1 / 8 * Math.PI;
            //As 2Pi radians = 0 radians
            if (i >= 2 * Math.PI) {
                i -= 2 * Math.PI;
            }
            //Returns the radians of planet
            return i;

        }

        //combines everything together
        function solarSystem() {
            //clear canvas for redrawing
            const ctx = myCanvas.getContext('2d');
            ctx.clearRect(0, 0, myCanvas.width, myCanvas.height);
            //draws the background
            ctx.drawImage(background, 0, 0);
            //draws the solar system
            drawSun();
            mercuryLoc = planets(mercury, "mercury", mercuryLoc);
            venusLoc = planets(venus, "venus", venusLoc);
            earthLoc = planets(earth, "earth", earthLoc);
            marsLoc = planets(mars, "mars", marsLoc);
            jupiterLoc = planets(jupiter, "jupiter", jupiterLoc);
            saturnLoc = planets(saturn, "saturn", saturnLoc);
            uranusLoc = planets(uranus, "uranus", uranusLoc);
            neptuneLoc = planets(neptune, "neptune", neptuneLoc);
            running = setTimeout(solarSystem, delay);
        }





        // Skolotāja funkcija attēlu gaidīšanai
        // Funkcijai gaida, kad norādītie attēli ir ielādējušies no tīkla un tad izsauc pirmajā parametrā norādīto funkciju.
        // Gaidīšanas laikā lapas apakšā (pēc visiem elementiem) uzrādās "Attēlu ielāde ...", kas pazūd brīdī, kad visi attēli ir ielādēti.
        // Autors:: 2018-2019 Ojārs Krūmiņš
        // Versija 1.3
        function gaidaAtteluIeladi() {
            var images = [].slice.call(arguments);
            var num = arguments.length;
            var l = document.createElement('div');
            l.id = "loading_div";
            l.innerHTML = "Attēlu ielāde ";
            document.body.appendChild(l);
            var lcount = 1;
            var interval = setInterval(function() {
                var n = 1;
                for (var i = 1; i < images.length; i++) {
                    if (images[i].complete) {
                        n++;
                    }
                }
                if (n == num) {
                    clearInterval(interval);
                    document.getElementById("loading_div").remove();
                    images[0]();
                }
                lcount = (lcount + 1) % 50 + 1;
                l.innerHTML = "Attēlu ielāde " + ".".repeat(lcount / 10);
            }, 10);
        }
    </script>

</body>

</html>